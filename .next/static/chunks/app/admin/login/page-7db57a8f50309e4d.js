(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2116],{439:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(78340).A)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},13545:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(78340).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},25777:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(78340).A)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},31069:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(78340).A)("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]])},54452:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(78340).A)("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]])},56323:(e,r,s)=>{Promise.resolve().then(s.bind(s,66365))},66365:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>x,dynamic:()=>u});var t=s(95155),a=s(12115),l=s(73321),o=s(31069),d=s(92289),n=s(25777),i=s(439),c=s(13545),m=s(54452);let u="force-dynamic";function h(){let e=(0,l.useRouter)(),[r,s]=(0,a.useState)({email:"",password:"",twoFactorCode:""}),[u,h]=(0,a.useState)(!1),[x,g]=(0,a.useState)(!1),[p,y]=(0,a.useState)(null);(0,a.useEffect)(()=>{let r=!0;return(async()=>{try{let s=localStorage.getItem("token");if(!s)return;let t=await fetch("/api/auth/validate",{method:"POST",headers:{Authorization:`Bearer ${s}`},credentials:"include"});if(t.ok&&r){let r=await t.json();r.valid&&r.user?.isAdmin&&(console.log("Admin already authenticated, redirecting to dashboard"),e.push("/admin/dashboard"))}}catch(e){r&&console.log("Not authenticated, showing login form")}})(),()=>{r=!1}},[e]);let f=async s=>{s.preventDefault(),g(!0),y(null);try{let s=await fetch("/api/admin/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:r.email,password:r.password,twoFactorCode:r.twoFactorCode||void 0})}),t=await s.json();if(console.log("Login response:",{status:s.status,data:t}),s.ok&&t.success){console.log("Admin login successful:",t.user),t.token&&(localStorage.setItem("token",t.token),console.log("✅ Token stored in localStorage")),t.refreshToken&&(localStorage.setItem("refreshToken",t.refreshToken),console.log("✅ Refresh token stored in localStorage")),t.user&&(localStorage.setItem("user",JSON.stringify(t.user)),console.log("✅ User data stored:",t.user.email));let r=sessionStorage.getItem("adminRedirectAfterLogin");r?(sessionStorage.removeItem("adminRedirectAfterLogin"),console.log("Redirecting to stored path:",r),e.push(r)):(console.log("Redirecting to admin dashboard"),e.push("/admin/dashboard"))}else t.requires2FA?(h(!0),y("Please enter your 2FA code")):(console.error("Login failed:",t),y(t.error||"Login failed"))}catch(e){console.error("Admin login error:",e),y("An error occurred during login. Please try again.")}finally{g(!1)}};return(0,t.jsx)("div",{className:"min-h-screen bg-black flex items-center justify-center p-4",children:(0,t.jsx)("div",{className:"bg-black border border-red-800 w-full max-w-md shadow-xl rounded-xl hover:border-red-600/50 transition-all",children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"text-center mb-6",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-red-900/30 rounded-xl flex items-center justify-center mx-auto mb-3",children:(0,t.jsx)(o.A,{className:"h-6 w-6 text-red-400"})}),(0,t.jsx)("h2",{className:"text-xl font-bold text-red-400",children:"Admin Access Portal"}),(0,t.jsx)("p",{className:"text-gray-400 text-xs mt-1",children:"Authorized Personnel Only"}),(0,t.jsx)("div",{className:"mt-2 px-3 py-1 bg-red-900/20 border border-red-800 rounded-lg",children:(0,t.jsx)("p",{className:"text-xs text-red-300",children:"⚠️ Admin credentials required"})})]}),(0,t.jsxs)("form",{onSubmit:f,className:"space-y-3",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"block",children:(0,t.jsx)("span",{className:"text-gray-300 text-sm font-medium",children:"Admin Email"})}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"email",placeholder:"Enter admin email",className:"w-full px-4 py-3 pl-10 bg-gray-900 border border-gray-700 rounded-lg focus:border-red-500 focus:ring-1 focus:ring-red-500 text-white text-sm placeholder-gray-500",value:r.email,onChange:e=>s({...r,email:e.target.value}),autoComplete:"email",required:!0}),(0,t.jsx)(d.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-500"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"block",children:(0,t.jsx)("span",{className:"text-gray-300 text-sm font-medium",children:"Admin Password"})}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"password",placeholder:"Enter admin password",className:"w-full px-4 py-3 pl-10 bg-gray-900 border border-gray-700 rounded-lg focus:border-red-500 focus:ring-1 focus:ring-red-500 text-white text-sm placeholder-gray-500",value:r.password,onChange:e=>s({...r,password:e.target.value}),autoComplete:"current-password",required:!0}),(0,t.jsx)(n.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-500"})]})]}),u&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"block",children:(0,t.jsx)("span",{className:"text-gray-300 text-sm font-medium",children:"2FA Code"})}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("input",{type:"text",placeholder:"Enter 6-digit code",className:"w-full px-4 py-3 pl-10 bg-gray-900 border border-gray-700 rounded-lg focus:border-red-500 focus:ring-1 focus:ring-red-500 text-white text-sm placeholder-gray-500",value:r.twoFactorCode,onChange:e=>s({...r,twoFactorCode:e.target.value}),maxLength:6,pattern:"[0-9]{6}"}),(0,t.jsx)(i.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-500"})]})]}),p&&(0,t.jsxs)("div",{className:"bg-red-900/20 border border-red-800 rounded-lg p-3 flex items-center gap-2",children:[(0,t.jsx)(c.A,{className:"h-4 w-4 text-red-400 flex-shrink-0"}),(0,t.jsx)("span",{className:"text-sm text-red-300",children:p})]}),(0,t.jsx)("button",{type:"submit",className:"w-full bg-red-600 hover:bg-red-700 text-white py-3 text-sm font-semibold mt-4 rounded-lg flex items-center justify-center gap-2 transition-all border border-red-600 hover:border-red-500",disabled:x,children:x?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Authenticating..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.A,{className:"h-4 w-4"}),"Access Admin Panel"]})})]}),(0,t.jsxs)("div",{className:"mt-6 text-center",children:[(0,t.jsxs)("div",{className:"flex items-center mb-3",children:[(0,t.jsx)("div",{className:"flex-1 h-px bg-gray-800"}),(0,t.jsx)("span",{className:"px-4 text-gray-500 text-xs",children:"SECURITY NOTICE"}),(0,t.jsx)("div",{className:"flex-1 h-px bg-gray-800"})]}),(0,t.jsx)("p",{className:"text-xs text-gray-500",children:"This is a restricted area. All access attempts are logged and monitored."}),(0,t.jsxs)("p",{className:"text-xs text-gray-600 mt-1",children:["Need user access? ",(0,t.jsx)("a",{href:"/login",className:"text-blue-400 hover:text-blue-300",children:"Go to User Login"})]})]})]})})})}function x(){return(0,t.jsx)(a.Suspense,{fallback:(0,t.jsx)("div",{className:"min-h-screen bg-black flex items-center justify-center",children:(0,t.jsx)("div",{className:"text-white",children:"Loading..."})}),children:(0,t.jsx)(h,{})})}},73321:(e,r,s)=>{"use strict";var t=s(74645);s.o(t,"useParams")&&s.d(r,{useParams:function(){return t.useParams}}),s.o(t,"usePathname")&&s.d(r,{usePathname:function(){return t.usePathname}}),s.o(t,"useRouter")&&s.d(r,{useRouter:function(){return t.useRouter}}),s.o(t,"useSearchParams")&&s.d(r,{useSearchParams:function(){return t.useSearchParams}})},78340:(e,r,s)=>{"use strict";s.d(r,{A:()=>d});var t=s(12115);let a=(...e)=>e.filter((e,r,s)=>!!e&&s.indexOf(e)===r).join(" ");var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,t.forwardRef)(({color:e="currentColor",size:r=24,strokeWidth:s=2,absoluteStrokeWidth:o,className:d="",children:n,iconNode:i,...c},m)=>(0,t.createElement)("svg",{ref:m,...l,width:r,height:r,stroke:e,strokeWidth:o?24*Number(s)/Number(r):s,className:a("lucide",d),...c},[...i.map(([e,r])=>(0,t.createElement)(e,r)),...Array.isArray(n)?n:[n]])),d=(e,r)=>{let s=(0,t.forwardRef)(({className:s,...l},d)=>(0,t.createElement)(o,{ref:d,iconNode:r,className:a(`lucide-${e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,s),...l}));return s.displayName=`${e}`,s}},92289:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(78340).A)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])}},e=>{e.O(0,[8441,3794,7358],()=>e(e.s=56323)),_N_E=e.O()}]);