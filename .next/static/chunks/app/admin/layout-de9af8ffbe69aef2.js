(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7581],{3092:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var n=r(95155),s=r(12115),a=r(73321),i=r(14111);function o({children:e}){let t=(0,a.useRouter)(),r=(0,a.usePathname)(),{user:o,isAuthenticated:u}=(0,i.A)(),[c,l]=(0,s.useState)(!1),[d,m]=(0,s.useState)(!0),[f,h]=(0,s.useState)(!1);(0,s.useEffect)(()=>{h(!0)},[]);let g=["/admin/login"].includes(r);return((0,s.useEffect)(()=>{if(!f)return;let e=!0;return(async()=>{if(!e)return;if(m(!0),g){e&&(l(!0),m(!1));return}let n=localStorage.getItem("token");if(!n){console.log("No token found, redirecting to admin login"),sessionStorage.setItem("adminRedirectAfterLogin",r),t.push("/admin/login");return}try{let s=await fetch("/api/auth/validate",{method:"POST",headers:{Authorization:`Bearer ${n}`},credentials:"include"});if(!e)return;if(s.ok){let t=await s.json();if(t.valid&&t.user?.isAdmin){console.log("Admin access verified for user:",t.user.email),e&&(l(!0),m(!1));return}}console.log("Token invalid or user not admin, redirecting to admin login"),localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),sessionStorage.setItem("adminRedirectAfterLogin",r),t.push("/admin/login")}catch(r){console.error("Admin auth check error:",r),e&&t.push("/admin/login")}})(),()=>{e=!1}},[f,t,g,r]),d||!c)?(0,n.jsx)("div",{className:"min-h-screen bg-black flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-red-500 border-t-transparent mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-gray-400 mb-2",children:"Verifying admin access..."}),!1]})}):(0,n.jsx)("div",{className:"min-h-screen bg-black",children:e})}},11498:(e,t,r)=>{"use strict";r.d(t,{vt:()=>l});var n=r(35867),s=r(12115),a=r(94577);let{useDebugValue:i}=s,{useSyncExternalStoreWithSelector:o}=a,u=!1,c=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let t="function"==typeof e?(0,n.y)(e):e,r=(e,r)=>(function(e,t=e=>e,r){r&&!u&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),u=!0);let n=o(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return i(n),n})(t,e,r);return Object.assign(r,t),r},l=e=>e?c(e):c},62495:(e,t,r)=>{Promise.resolve().then(r.bind(r,3092))},73321:(e,t,r)=>{"use strict";var n=r(74645);r.o(n,"useParams")&&r.d(t,{useParams:function(){return n.useParams}}),r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})}},e=>{e.O(0,[2712,4111,8441,3794,7358],()=>e(e.s=62495)),_N_E=e.O()}]);