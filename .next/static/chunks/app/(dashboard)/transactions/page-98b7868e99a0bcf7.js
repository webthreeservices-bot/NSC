(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3486],{35082:(e,t,r)=>{"use strict";function s(){try{let e=localStorage.getItem("token");if(!e&&(e=c("token")))try{localStorage.setItem("token",e),console.log("\uD83D\uDD04 Token synced from cookie to localStorage")}catch(e){console.warn("⚠️ Could not sync token to localStorage:",e)}return e?console.log("✅ Token found in storage"):console.log("❌ No token found in storage or cookies"),e}catch(e){return console.error("❌ Error getting token from storage:",e),c("token")}}function l(e){try{localStorage.setItem("token",e),i("token",e,7),console.log("✅ Token stored in localStorage and cookie")}catch(t){console.error("❌ Error storing token:",t);try{i("token",e,7),console.log("✅ Token stored in cookie only")}catch(e){console.error("❌ Failed to store token anywhere:",e)}}}function n(){try{localStorage.removeItem("token"),localStorage.removeItem("refreshToken"),d("token"),d("refreshToken"),console.log("✅ All tokens cleared from storage and cookies")}catch(e){console.error("❌ Error clearing tokens:",e)}}function a(){try{let e=localStorage.getItem("refreshToken");if(!e&&(e=c("refreshToken")))try{localStorage.setItem("refreshToken",e)}catch(e){}return e}catch(e){return c("refreshToken")}}function o(e){try{localStorage.setItem("refreshToken",e),i("refreshToken",e,30)}catch(e){}}function c(e){if("undefined"==typeof document)return null;try{let t=`; ${document.cookie}`.split(`; ${e}=`);if(2===t.length){let e=t.pop();if(e)return e.split(";").shift()||null}return null}catch(e){return null}}function i(e,t,r){if("undefined"!=typeof document)try{let s=new Date;s.setTime(s.getTime()+24*r*36e5),document.cookie=`${e}=${t};expires=${s.toUTCString()};path=/;SameSite=Lax`}catch(e){console.error("Error setting cookie:",e)}}function d(e){if("undefined"!=typeof document)try{document.cookie=`${e}=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/;`}catch(e){console.error("Error deleting cookie:",e)}}function x(){let e=s();if(!e)return null;try{let t=e.split(".");if(3!==t.length)return null;let r=t[1];if(!r)return null;let s=r.replace(/-/g,"+").replace(/_/g,"/"),l=decodeURIComponent(atob(s).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(l)}catch(e){return console.error("Error decoding token:",e),null}}r.d(t,{C$:()=>l,Do:()=>n,G:()=>a,LJ:()=>s,RX:()=>o,l4:()=>x})},41537:(e,t,r)=>{Promise.resolve().then(r.bind(r,85649))},85649:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>A});var s=r(95155),l=r(12115),n=r(73321),a=r(79984),o=r(38291),c=r(4474),i=r(39658),d=r(83786),x=r(26518),h=r(35082),u=r(80840),m=r(81890),j=r(6296),g=r(44071),f=r(76498),p=r(61878),N=r(4736),b=r(6962),y=r(42268),w=r(22164);function A(){let e=(0,n.useRouter)(),{error:t,success:r}=(0,m.d)(),[A,k]=(0,l.useState)([]),[v,E]=(0,l.useState)(!0),[T,L]=(0,l.useState)(""),[C,S]=(0,l.useState)("ALL"),[I,R]=(0,l.useState)("ALL");(0,l.useEffect)(()=>{O()},[]);let O=async()=>{E(!0);try{let t=(0,h.LJ)();if(!t)return void e.push("/login");let r=await fetch("/api/transactions",{headers:{Authorization:`Bearer ${t}`}});if(!r.ok)throw Error("Failed to fetch transactions");let s=await r.json();k(s.transactions||[])}catch(e){console.error("Failed to fetch transactions:",e),t("Failed to load transactions")}finally{E(!1)}},P=(e,t)=>e?"BEP20"===t||"BSC"===t?`https://bscscan.com/tx/${e}`:"TRC20"===t||"TRON"===t?`https://tronscan.org/#/transaction/${e}`:null:null,D=A.filter(e=>{let t=e.description.toLowerCase().includes(T.toLowerCase())||e.txHash?.toLowerCase().includes(T.toLowerCase())||e.id.toLowerCase().includes(T.toLowerCase()),r="ALL"===C||e.type===C,s="ALL"===I||e.status===I;return t&&r&&s});if(v)return(0,s.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,s.jsx)(j.A,{className:"w-8 h-8 animate-spin text-green-500"})});let B=A.reduce((e,t)=>"COMPLETED"===t.status?e+Number(t.amount):e,0);return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold tracking-tight",children:"Transaction History"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"View all your transactions including purchases, activations, and earnings"})]}),(0,s.jsxs)("div",{className:"grid gap-3 md:grid-cols-2 lg:grid-cols-4",children:[(0,s.jsxs)(a.Zp,{className:"bg-gradient-to-br from-blue-500/10 to-blue-600/5 border-blue-500/20",children:[(0,s.jsxs)(a.aR,{className:"flex flex-row items-center justify-between pb-2 space-y-0",children:[(0,s.jsx)(a.ZB,{className:"text-xs font-medium text-muted-foreground",children:"Total Transactions"}),(0,s.jsx)(g.A,{className:"h-3.5 w-3.5 text-blue-500"})]}),(0,s.jsx)(a.Wu,{className:"pb-2",children:(0,s.jsx)("div",{className:"text-xl font-bold",children:A.length})})]}),(0,s.jsxs)(a.Zp,{className:"bg-gradient-to-br from-green-500/10 to-green-600/5 border-green-500/20",children:[(0,s.jsxs)(a.aR,{className:"flex flex-row items-center justify-between pb-2 space-y-0",children:[(0,s.jsx)(a.ZB,{className:"text-xs font-medium text-muted-foreground",children:"Completed"}),(0,s.jsx)(g.A,{className:"h-3.5 w-3.5 text-green-500"})]}),(0,s.jsx)(a.Wu,{className:"pb-2",children:(0,s.jsx)("div",{className:"text-xl font-bold text-green-400",children:A.filter(e=>"COMPLETED"===e.status).length})})]}),(0,s.jsxs)(a.Zp,{className:"bg-gradient-to-br from-yellow-500/10 to-yellow-600/5 border-yellow-500/20",children:[(0,s.jsxs)(a.aR,{className:"flex flex-row items-center justify-between pb-2 space-y-0",children:[(0,s.jsx)(a.ZB,{className:"text-xs font-medium text-muted-foreground",children:"Pending"}),(0,s.jsx)(j.A,{className:"h-3.5 w-3.5 text-yellow-500"})]}),(0,s.jsx)(a.Wu,{className:"pb-2",children:(0,s.jsx)("div",{className:"text-xl font-bold text-yellow-400",children:A.filter(e=>"PENDING"===e.status).length})})]}),(0,s.jsxs)(a.Zp,{className:"bg-gradient-to-br from-purple-500/10 to-purple-600/5 border-purple-500/20",children:[(0,s.jsxs)(a.aR,{className:"flex flex-row items-center justify-between pb-2 space-y-0",children:[(0,s.jsx)(a.ZB,{className:"text-xs font-medium text-muted-foreground",children:"Total Amount"}),(0,s.jsx)(f.A,{className:"h-3.5 w-3.5 text-purple-500"})]}),(0,s.jsx)(a.Wu,{className:"pb-2",children:(0,s.jsxs)("div",{className:"text-xl font-bold text-purple-400",children:["$",B.toFixed(2)]})})]})]}),(0,s.jsx)(a.Zp,{className:"mb-6",children:(0,s.jsx)(a.Wu,{className:"pt-6",children:(0,s.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(p.A,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),(0,s.jsx)(i.p,{placeholder:"Search by description, transaction hash, or ID...",value:T,onChange:e=>L(e.target.value),className:"pl-9"})]})}),(0,s.jsxs)(x.l6,{value:C,onValueChange:S,children:[(0,s.jsxs)(x.bq,{className:"w-full md:w-[200px]",children:[(0,s.jsx)(N.A,{className:"h-4 w-4 mr-2"}),(0,s.jsx)(x.yv,{placeholder:"Filter by type"})]}),(0,s.jsxs)(x.gC,{children:[(0,s.jsx)(x.eb,{value:"ALL",children:"All Types"}),(0,s.jsx)(x.eb,{value:"PACKAGE_PURCHASE",children:"Package Purchase"}),(0,s.jsx)(x.eb,{value:"BOT_ACTIVATION",children:"Bot Activation"}),(0,s.jsx)(x.eb,{value:"WITHDRAWAL",children:"Withdrawal"}),(0,s.jsx)(x.eb,{value:"ROI_PAYMENT",children:"ROI Payment"}),(0,s.jsx)(x.eb,{value:"REFERRAL_BONUS",children:"Referral Bonus"}),(0,s.jsx)(x.eb,{value:"LEVEL_INCOME",children:"Level Income"})]})]}),(0,s.jsxs)(x.l6,{value:I,onValueChange:R,children:[(0,s.jsx)(x.bq,{className:"w-full md:w-[200px]",children:(0,s.jsx)(x.yv,{placeholder:"Filter by status"})}),(0,s.jsxs)(x.gC,{children:[(0,s.jsx)(x.eb,{value:"ALL",children:"All Status"}),(0,s.jsx)(x.eb,{value:"COMPLETED",children:"Completed"}),(0,s.jsx)(x.eb,{value:"PENDING",children:"Pending"}),(0,s.jsx)(x.eb,{value:"FAILED",children:"Failed"}),(0,s.jsx)(x.eb,{value:"CANCELLED",children:"Cancelled"})]})]}),(0,s.jsxs)(c.$,{onClick:()=>{let e=D.map(e=>({Date:(0,u.r6)(e.createdAt),Type:e.type,Amount:`$${e.amount}`,Status:e.status,Description:e.description,"Transaction Hash":e.txHash||"N/A",Network:e.network||"N/A"})),t=new Blob([[Object.keys(e[0]).join(","),...e.map(e=>Object.values(e).join(","))].join("\n")],{type:"text/csv"}),s=window.URL.createObjectURL(t),l=document.createElement("a");l.href=s,l.download=`transactions-${new Date().toISOString().split("T")[0]}.csv`,l.click(),window.URL.revokeObjectURL(s),r("Transactions exported successfully")},variant:"outline",className:"w-full md:w-auto",disabled:0===D.length,children:[(0,s.jsx)(b.A,{className:"h-4 w-4 mr-2"}),"Export CSV"]})]})})}),(0,s.jsxs)(a.Zp,{children:[(0,s.jsxs)(a.aR,{children:[(0,s.jsx)(a.ZB,{children:"All Transactions"}),(0,s.jsxs)(a.BT,{children:["Showing ",D.length," of ",A.length," transactions"]})]}),(0,s.jsx)(a.Wu,{children:0===D.length?(0,s.jsxs)("div",{className:"text-center py-12 text-gray-400",children:[(0,s.jsx)(y.A,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),(0,s.jsx)("p",{children:"No transactions found"})]}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)(d.XI,{children:[(0,s.jsx)(d.A0,{children:(0,s.jsxs)(d.Hj,{children:[(0,s.jsx)(d.nd,{children:"Date"}),(0,s.jsx)(d.nd,{children:"Type"}),(0,s.jsx)(d.nd,{children:"Description"}),(0,s.jsx)(d.nd,{className:"text-right",children:"Amount"}),(0,s.jsx)(d.nd,{children:"Status"}),(0,s.jsx)(d.nd,{children:"Network"}),(0,s.jsx)(d.nd,{children:"Transaction Hash"})]})}),(0,s.jsx)(d.BF,{children:D.map(e=>{var t,r;let l;return(0,s.jsxs)(d.Hj,{children:[(0,s.jsx)(d.nA,{className:"font-mono text-xs",children:(0,u.r6)(e.createdAt)}),(0,s.jsx)(d.nA,{children:(t=e.type,(0,s.jsx)(o.E,{variant:"outline",className:"bg-blue-500/10 text-blue-400 border-blue-500",children:{PACKAGE_PURCHASE:"Package Purchase",BOT_ACTIVATION:"Bot Activation",WITHDRAWAL:"Withdrawal",REFERRAL_BONUS:"Referral Bonus",LEVEL_INCOME:"Level Income",ROI_PAYMENT:"ROI Payment",DEPOSIT:"Deposit",REFUND:"Refund"}[t]||t.replace(/_/g," ")}))}),(0,s.jsx)(d.nA,{className:"max-w-xs truncate",children:e.description}),(0,s.jsxs)(d.nA,{className:"text-right font-bold",children:["$",Number(e.amount).toFixed(2)]}),(0,s.jsx)(d.nA,{children:(l=({COMPLETED:{className:"bg-green-500/20 text-green-400 border-green-500",label:"Completed"},PENDING:{className:"bg-yellow-500/20 text-yellow-400 border-yellow-500",label:"Pending"},FAILED:{className:"bg-red-500/20 text-red-400 border-red-500",label:"Failed"},CANCELLED:{className:"bg-gray-500/20 text-gray-400 border-gray-500",label:"Cancelled"}})[r=e.status]||{className:"bg-gray-500/20 text-gray-400 border-gray-500",label:r},(0,s.jsx)(o.E,{variant:"outline",className:l.className,children:l.label}))}),(0,s.jsx)(d.nA,{children:e.network?(0,s.jsx)(o.E,{variant:"outline",className:"text-xs",children:e.network}):(0,s.jsx)("span",{className:"text-gray-500 text-xs",children:"N/A"})}),(0,s.jsx)(d.nA,{children:e.txHash?(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("code",{className:"text-xs text-gray-400",children:[e.txHash.slice(0,8),"...",e.txHash.slice(-6)]}),e.network&&P(e.txHash,e.network)&&(0,s.jsx)("a",{href:P(e.txHash,e.network),target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300",children:(0,s.jsx)(w.A,{className:"h-4 w-4"})})]}):(0,s.jsx)("span",{className:"text-gray-500 text-xs",children:"N/A"})})]},e.id)})})]})})})]})]})}}},e=>{e.O(0,[8409,6609,2263,4675,7925,8441,3794,7358],()=>e(e.s=41537)),_N_E=e.O()}]);