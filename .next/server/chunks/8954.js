"use strict";exports.id=8954,exports.ids=[8954],exports.modules={8954:(a,b,c)=>{var d=c(63043),e=c(55511),f=c(1932),g=c(28354);b.digest=function(a){var b,c=a.secret,f=a.counter,g=a.encoding||"ascii",h=(a.algorithm||"sha1").toLowerCase();null!=a.key&&(console.warn("Speakeasy - Deprecation Notice - Specifying the secret using `key` is no longer supported. Use `secret` instead."),c=a.key),Buffer.isBuffer(c)||(c="base32"===g?d.decode(c):new Buffer(c,g));var i=new Buffer(8),j=f;for(b=0;b<8;b++)i[7-b]=255&j,j>>=8;var k=e.createHmac(h,c);return k.update(i),k.digest()},b.hotp=function(a){var c=(null!=a.digits?a.digits:a.length)||6;null!=a.length&&console.warn("Speakeasy - Deprecation Notice - Specifying token digits using `length` is no longer supported. Use `digits` instead.");var d=a.digest||b.digest(a),e=15&d[d.length-1],f=(127&d[e])<<24|(255&d[e+1])<<16|(255&d[e+2])<<8|255&d[e+3];return(f=Array(c+1).join("0")+f.toString(10)).substr(-c)},b.counter=b.hotp,b.hotp.verifyDelta=function(a){var c,d=String((a=Object.create(a)).token),e=parseInt(a.digits,10)||6,f=parseInt(a.window,10)||0,g=parseInt(a.counter,10)||0;if(d.length===e&&!isNaN(d=parseInt(d,10))){for(c=g;c<=g+f;++c)if(a.counter=c,parseInt(b.hotp(a),10)===d)return{delta:c-g}}},b.hotp.verify=function(a){return null!=b.hotp.verifyDelta(a)},b._counter=function(a){var b=a.step||30,c=null!=a.time?1e3*a.time:Date.now(),d=(null!=a.epoch?1e3*a.epoch:1e3*a.initial_time)||0;return null!=a.initial_time&&console.warn("Speakeasy - Deprecation Notice - Specifying the epoch using `initial_time` is no longer supported. Use `epoch` instead."),Math.floor((c-d)/b/1e3)},b.totp=function(a){return null==(a=Object.create(a)).counter&&(a.counter=b._counter(a)),this.hotp(a)},b.time=b.totp,b.totp.verifyDelta=function(a){var c=parseInt((a=Object.create(a)).window,10)||0;null==a.counter&&(a.counter=b._counter(a)),a.counter-=c,a.window+=c;var d=b.hotp.verifyDelta(a);return d&&(d.delta-=c),d},b.totp.verify=function(a){return null!=b.totp.verifyDelta(a)},b.generateSecret=function(a){a||(a={});var c=a.length||32,e=encodeURIComponent(a.name||"SecretKey"),f=a.qr_codes||!1,g=a.google_auth_qr||!1,h=null==a.otpauth_url||a.otpauth_url,i=!0;void 0!==a.symbols&&!1===a.symbols&&(i=!1);var j=this.generateSecretASCII(c,i),k={};return k.ascii=j,k.hex=Buffer(j,"ascii").toString("hex"),k.base32=d.encode(Buffer(j)).toString().replace(/=/g,""),f&&(console.warn("Speakeasy - Deprecation Notice - generateSecret() QR codes are deprecated and no longer supported. Please use your own QR code implementation."),k.qr_code_ascii="https://chart.googleapis.com/chart?chs=166x166&chld=L|0&cht=qr&chl="+encodeURIComponent(k.ascii),k.qr_code_hex="https://chart.googleapis.com/chart?chs=166x166&chld=L|0&cht=qr&chl="+encodeURIComponent(k.hex),k.qr_code_base32="https://chart.googleapis.com/chart?chs=166x166&chld=L|0&cht=qr&chl="+encodeURIComponent(k.base32)),h&&(k.otpauth_url=b.otpauthURL({secret:k.ascii,label:e})),g&&(console.warn("Speakeasy - Deprecation Notice - generateSecret() Google Auth QR code is deprecated and no longer supported. Please use your own QR code implementation."),k.google_auth_qr="https://chart.googleapis.com/chart?chs=166x166&chld=L|0&cht=qr&chl="+encodeURIComponent(b.otpauthURL({secret:k.base32,label:e}))),k},b.generate_key=g.deprecate(function(a){return b.generateSecret(a)},"Speakeasy - Deprecation Notice - `generate_key()` is depreciated, please use `generateSecret()` instead."),b.generateSecretASCII=function(a,b){var c=e.randomBytes(a||32),d="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz";b&&(d+="!@#$%^&*()<>?/[]{},.:;");for(var f="",g=0,h=c.length;g<h;g++)f+=d[Math.floor(c[g]/255*(d.length-1))];return f},b.generate_key_ascii=g.deprecate(function(a,c){return b.generateSecretASCII(a,c)},"Speakeasy - Deprecation Notice - `generate_key_ascii()` is depreciated, please use `generateSecretASCII()` instead."),b.otpauthURL=function(a){var b=a.secret,c=a.label,e=a.issuer,g=(a.type||"totp").toLowerCase(),h=a.counter,i=a.algorithm,j=a.digits,k=a.period,l=a.encoding||"ascii";switch(g){case"totp":case"hotp":break;default:throw Error("Speakeasy - otpauthURL - Invalid type `"+g+"`; must be `hotp` or `totp`")}if(!b)throw Error("Speakeasy - otpauthURL - Missing secret");if(!c)throw Error("Speakeasy - otpauthURL - Missing label");if("hotp"===g&&null==h)throw Error("Speakeasy - otpauthURL - Missing counter value for HOTP");"base32"!==l&&(b=new Buffer(b,l)),Buffer.isBuffer(b)&&(b=d.encode(b));var m={secret:b};if(e&&(m.issuer=e),null!=i){switch(i.toUpperCase()){case"SHA1":case"SHA256":case"SHA512":break;default:console.warn("Speakeasy - otpauthURL - Warning - Algorithm generally should be SHA1, SHA256, or SHA512")}m.algorithm=i.toUpperCase()}if(null!=j){if(isNaN(j))throw Error("Speakeasy - otpauthURL - Invalid digits `"+j+"`");switch(parseInt(j,10)){case 6:case 8:break;default:console.warn("Speakeasy - otpauthURL - Warning - Digits generally should be either 6 or 8")}m.digits=j}if(null!=k){if(~~(k=parseInt(k,10))!==k)throw Error("Speakeasy - otpauthURL - Invalid period `"+k+"`");m.period=k}return f.format({protocol:"otpauth",slashes:!0,hostname:g,pathname:c,query:m})}},14887:(a,b)=>{var c=function(a,b){return b||(b={}),a.split("").forEach(function(a,c){a in b||(b[a]=c)}),b},d={alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",charmap:{0:14,1:8}};d.charmap=c(d.alphabet,d.charmap);var e={alphabet:"0123456789ABCDEFGHJKMNPQRSTVWXYZ",charmap:{O:0,I:1,L:1}};function f(a){if(this.buf=[],this.shift=8,this.carry=0,a){switch(a.type){case"rfc4648":this.charmap=b.rfc4648.charmap;break;case"crockford":this.charmap=b.crockford.charmap;break;default:throw Error("invalid type")}a.charmap&&(this.charmap=a.charmap)}}function g(a){if(this.buf="",this.shift=3,this.carry=0,a){switch(a.type){case"rfc4648":this.alphabet=b.rfc4648.alphabet;break;case"crockford":this.alphabet=b.crockford.alphabet;break;default:throw Error("invalid type")}a.alphabet?this.alphabet=a.alphabet:a.lc&&(this.alphabet=this.alphabet.toLowerCase())}}e.charmap=c(e.alphabet,e.charmap),f.prototype.charmap=d.charmap,f.prototype.write=function(a){var b=this.charmap,c=this.buf,d=this.shift,e=this.carry;return a.toUpperCase().split("").forEach(function(a){if("="!=a){var f=255&b[a];(d-=5)>0?e|=f<<d:d<0?(c.push(e|f>>-d),d+=8,e=f<<d&255):(c.push(e|f),d=8,e=0)}}),this.shift=d,this.carry=e,this},f.prototype.finalize=function(a){return a&&this.write(a),8!==this.shift&&0!==this.carry&&(this.buf.push(this.carry),this.shift=8,this.carry=0),this.buf},g.prototype.alphabet=d.alphabet,g.prototype.write=function(a){var b,c,d,e=this.shift,f=this.carry;for(d=0;d<a.length;d++)b=f|(c=a[d])>>e,this.buf+=this.alphabet[31&b],e>5&&(e-=5,b=c>>e,this.buf+=this.alphabet[31&b]),f=c<<(e=5-e),e=8-e;return this.shift=e,this.carry=f,this},g.prototype.finalize=function(a){return a&&this.write(a),3!==this.shift&&(this.buf+=this.alphabet[31&this.carry],this.shift=3,this.carry=0),this.buf},b.encode=function(a,b){return new g(b).finalize(a)},b.decode=function(a,b){return new f(b).finalize(a)},b.Decoder=f,b.Encoder=g,b.charmap=c,b.crockford=e,b.rfc4648=d},63043:(a,b,c)=>{var d=c(14887),e=d.Decoder.prototype.finalize;d.Decoder.prototype.finalize=function(a){return new Buffer(e.call(this,a))},a.exports=d}};