exports.id=1204,exports.ids=[1204],exports.modules={8216:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{BR:()=>j,Cb:()=>g,P:()=>h,Rn:()=>l,Zy:()=>i,g7:()=>k});var e=c(86165),f=a([e]);function g(a){return Array.isArray(a)?a.map(g):null!==a&&"object"==typeof a?Object.keys(a).reduce((b,c)=>(b[c.replace(/_([a-z])/g,a=>a[1].toUpperCase())]=g(a[c]),b),{}):a}async function h(a,b=[]){if("string"!=typeof a||0===a.trim().length){let b=Error("A query must have either text or a name. Supplying neither is unsupported.");throw console.error("PostgreSQL Error:",{message:b.message,sql:a,code:void 0}),b}try{return(await e.Ay.query(a,b)).rows}catch(b){throw console.error("PostgreSQL Error:",{message:b.message,sql:"string"==typeof a?a.substring(0,200):a,code:b.code}),b}}async function i(a,b=[]){let c=await h(a,b);return c.length>0?c[0]:null}async function j(a,b=[]){let c=await h(a,b);return 0===c.length?null:Object.values(c[0])[0]}async function k(a,b=[]){if("string"!=typeof a||0===a.trim().length){let b=Error("A query must have either text or a name. Supplying neither is unsupported.");throw console.error("PostgreSQL Error:",{message:b.message,sql:a,code:void 0}),b}try{return(await e.Ay.query(a,b)).rowCount||0}catch(b){throw console.error("PostgreSQL Error:",{message:b.message,sql:"string"==typeof a?a.substring(0,200):a,code:b.code}),b}}async function l(a){let b=await e.Ay.connect();try{await b.query("BEGIN");let c=await a(b);return await b.query("COMMIT"),c}catch(a){throw await b.query("ROLLBACK"),a}finally{b.release()}}e=(f.then?(await f)():f)[0],new Proxy({},{get:(a,b)=>{if("string"==typeof b)return{async findUnique({where:a,select:c}){let[d,e]=Object.entries(a)[0],f=c?Object.keys(c).map(a=>`"${a}"`).join(", "):"*",h=await i(`SELECT ${f} FROM "${b}" WHERE "${d}" = $1 LIMIT 1`,[e]);return h?g(h):null},async findMany({where:a,select:c,orderBy:d,take:e,skip:f}={}){let i=[],j=c?Object.keys(c).map(a=>`"${a}"`).join(", "):"*",k=`SELECT ${j} FROM "${b}"`;if(a){let b=[];for(let[c,d]of Object.entries(a))if(null===d)b.push(`"${c}" IS NULL`);else if("object"==typeof d&&null!==d)if("in"in d){let a=d.in.map((a,b)=>`$${i.length+b+1}`).join(", ");i.push(...d.in),b.push(`"${c}" IN (${a})`)}else if("notIn"in d){let a=d.notIn.map((a,b)=>`$${i.length+b+1}`).join(", ");i.push(...d.notIn),b.push(`"${c}" NOT IN (${a})`)}else"lt"in d?(i.push(d.lt),b.push(`"${c}" < $${i.length}`)):"lte"in d?(i.push(d.lte),b.push(`"${c}" <= $${i.length}`)):"gt"in d?(i.push(d.gt),b.push(`"${c}" > $${i.length}`)):"gte"in d?(i.push(d.gte),b.push(`"${c}" >= $${i.length}`)):"contains"in d?(i.push(`%${d.contains}%`),b.push(`"${c}" ILIKE $${i.length}`)):"startsWith"in d?(i.push(`${d.startsWith}%`),b.push(`"${c}" ILIKE $${i.length}`)):"endsWith"in d?(i.push(`%${d.endsWith}`),b.push(`"${c}" ILIKE $${i.length}`)):"not"in d?(i.push(d.not),b.push(`"${c}" != $${i.length}`)):(i.push(d),b.push(`"${c}" = $${i.length}`));else i.push(d),b.push(`"${c}" = $${i.length}`);b.length&&(k+=` WHERE ${b.join(" AND ")}`)}if(d){let a=[];for(let[b,c]of Object.entries(d))a.push(`"${b}" ${c.toUpperCase()}`);k+=` ORDER BY ${a.join(", ")}`}return e&&(k+=` LIMIT ${e}`),f&&(k+=` OFFSET ${f}`),(await h(k,i)).map(a=>g(a))},async findFirst({where:a,select:b,orderBy:c}){let d=await this.findMany({where:a,select:b,orderBy:c,take:1});return d.length>0?d[0]:null},async count({where:a}={}){let c=[],d=`SELECT COUNT(*) as cnt FROM "${b}"`;if(a){let b=[];for(let[d,e]of Object.entries(a))if(null===e)b.push(`"${d}" IS NULL`);else if("object"==typeof e&&null!==e)if("in"in e){let a=e.in.map((a,b)=>`$${c.length+b+1}`).join(", ");c.push(...e.in),b.push(`"${d}" IN (${a})`)}else"not"in e?(c.push(e.not),b.push(`"${d}" != $${c.length}`)):(c.push(e),b.push(`"${d}" = $${c.length}`));else c.push(e),b.push(`"${d}" = $${c.length}`);b.length&&(d+=` WHERE ${b.join(" AND ")}`)}let e=await i(d,c);return e?parseInt(e.cnt):0},async create({data:a,select:c}){let d=Object.keys(a),e=Object.values(a),f=d.map((a,b)=>`$${b+1}`).join(", "),h=d.map(a=>`"${a}"`).join(", "),j=c?Object.keys(c).map(a=>`"${a}"`).join(", "):"*",k=await i(`INSERT INTO "${b}" (${h}) VALUES (${f}) RETURNING ${j}`,e);return k?g(k):null},async update({where:a,data:c,select:d}){let e=[],f=[];for(let[a,b]of Object.entries(c))void 0!==b&&("object"==typeof b&&null!==b?"increment"in b?(e.push(b.increment),f.push(`"${a}" = COALESCE("${a}", 0) + $${e.length}`)):"decrement"in b?(e.push(b.decrement),f.push(`"${a}" = COALESCE("${a}", 0) - $${e.length}`)):(e.push(JSON.stringify(b)),f.push(`"${a}" = $${e.length}`)):(e.push(b),f.push(`"${a}" = $${e.length}`)));let h=[];for(let[b,c]of Object.entries(a))e.push(c),h.push(`"${b}" = $${e.length}`);let j=d?Object.keys(d).map(a=>`"${a}"`).join(", "):"*",k=await i(`UPDATE "${b}" SET ${f.join(", ")} WHERE ${h.join(" AND ")} RETURNING ${j}`,e);return k?g(k):null},async delete({where:a}){let[c,d]=Object.entries(a)[0];return await k(`DELETE FROM "${b}" WHERE "${c}" = $1`,[d]),{}},async deleteMany({where:a}={}){let c=[],d=`DELETE FROM "${b}"`;if(a){let b=[];for(let[d,e]of Object.entries(a))c.push(e),b.push(`"${d}" = $${c.length}`);b.length&&(d+=` WHERE ${b.join(" AND ")}`)}return{count:await k(d,c)}},async aggregate({where:a,_sum:c,_count:d}){let e=[],f=[];c&&Object.keys(c).forEach(a=>{f.push(`SUM("${a}") as sum_${a}`)}),d&&f.push("COUNT(*) as cnt");let g=`SELECT ${f.join(", ")} FROM "${b}"`;if(a){let b=[];for(let[c,d]of Object.entries(a))e.push(d),b.push(`"${c}" = $${e.length}`);b.length&&(g+=` WHERE ${b.join(" AND ")}`)}let h=await i(g,e),j={};return c&&h&&(j._sum={},Object.keys(c).forEach(a=>{j._sum[a]=h[`sum_${a}`]?parseFloat(h[`sum_${a}`]):0})),d&&h&&(j._count=h.cnt?parseInt(h.cnt):0),j},async groupBy({by:a,_count:c,_sum:d,where:e}){let f=[],g=(Array.isArray(a)?a:[a]).map(a=>`"${a}"`),i=[];c&&i.push("COUNT(*) as cnt"),d&&Object.keys(d).forEach(a=>{i.push(`SUM("${a}") as sum_${a}`)});let j=`SELECT ${g.join(", ")}${i.length?", "+i.join(", "):""} FROM "${b}"`;if(e){let a=[];for(let[b,c]of Object.entries(e))f.push(c),a.push(`"${b}" = $${f.length}`);a.length&&(j+=` WHERE ${a.join(" AND ")}`)}return j+=` GROUP BY ${g.join(", ")}`,(await h(j,f)).map(b=>{let e=({})(Array.isArray(a)?a:[a]).forEach(a=>{e[a]=b[a]});return c&&(e._count=b.cnt?parseInt(b.cnt):0),d&&(e._sum={},Object.keys(d).forEach(a=>{e._sum[a]=b[`sum_${a}`]?parseFloat(b[`sum_${a}`]):0})),e})},async upsert({where:a,create:b,update:c}){return await this.findUnique({where:a})?this.update({where:a,data:c}):this.create({data:b})}}}}),e.Ay,d()}catch(a){d(a)}})},78335:()=>{},86165:(a,b,c)=>{"use strict";c.a(a,async(a,d)=>{try{c.d(b,{$b:()=>h,Ay:()=>n,Ug:()=>j,jG:()=>i,testConnection:()=>g});var e=c(64939),f=a([e]);e=(f.then?(await f)():f)[0];let k=null,l=!1,m=()=>{if(!k&&!l){l=!0;try{(k=new e.Pool((()=>{let a=process.env.DATABASE_URL;if(!a)throw console.error("❌ DATABASE_URL is not defined in environment variables"),console.error("Please ensure your .env file contains a valid DATABASE_URL"),Error("DATABASE_URL is not defined in environment variables");let b=a.includes("neon.tech")||a.includes("supabase.co")||a.includes("amazonaws.com")||a.includes("azure.com"),c=a.includes("neon.tech")?{rejectUnauthorized:!1,ca:null,checkServerIdentity:()=>void 0}:{rejectUnauthorized:"false"!==process.env.DB_SSL_REJECT_UNAUTHORIZED};return{connectionString:a,ssl:!!b&&c,max:20,min:5,idleTimeoutMillis:6e4,connectionTimeoutMillis:2e4,allowExitOnIdle:!1,statement_timeout:6e4,query_timeout:6e4,keepAlive:!0,keepAliveInitialDelayMillis:5e3,application_name:"nsc-bot-platform",idle_in_transaction_session_timeout:12e4}})())).on("error",a=>{console.error("❌ Unexpected error on idle client:",a),console.error("Connection will be removed from pool and recreated automatically")});let a="phase-production-build"===process.env.NEXT_PHASE;a||"true"!==process.env.VERBOSE_DB_LOGS||(k.on("connect",a=>{console.log("✅ New client connected to NeonDB")}),k.on("remove",a=>{console.log("\uD83D\uDD0C Client removed from pool")})),a||console.log("\uD83D\uDE80 Database pool initialized for NeonDB")}catch(a){throw l=!1,console.error("❌ Failed to initialize database pool:",a),a}finally{l=!1}}for(;l&&!k;);return k};async function g(){let a;try{let b=m();a=await b.connect();let c=await a.query("SELECT NOW()");return console.log("Database connection successful:",c.rows[0]),!0}catch(a){return console.error("Database connection error:",a),!1}finally{a&&a.release()}}async function h(){if("phase-production-build"!==process.env.NEXT_PHASE){console.log("\uD83D\uDD25 Warming up database connection...");try{if(await g()){console.log("✅ Database connection warmed up successfully");let a=m(),b=await a.connect();setTimeout(()=>{b.release(),console.log("\uD83D\uDD0C Warmup connection released")},1e3)}else console.warn("⚠️ Database warmup failed, but continuing...")}catch(a){console.warn("⚠️ Database warmup error:",a?.message||"Unknown error")}}}async function i(a=2e4){let b=m();return Promise.race([b.connect(),new Promise((b,c)=>setTimeout(()=>c(Error(`Database connection timeout after ${a}ms`)),a))])}async function j(a,b=[],c=2e4){let d;try{let e=(d=await i(c)).query(a,b),f=new Promise((a,b)=>setTimeout(()=>b(Error(`Query timeout after ${c}ms`)),c));return await Promise.race([e,f])}finally{d&&d.release()}}let n=new Proxy({},{get:(a,b)=>m()[b]});d()}catch(a){d(a)}})},96487:()=>{}};